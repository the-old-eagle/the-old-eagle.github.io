webpackJsonp([1],{"9bBU":function(t,e,i){i("mClu");var n=i("FeBl").Object;t.exports=function(t,e,i){return n.defineProperty(t,e,i)}},C4MV:function(t,e,i){t.exports={default:i("9bBU"),__esModule:!0}},Us0B:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,a=i("bOdI"),o=i.n(a),r=i("BO1k"),l=i.n(r),s=i("Dd8w"),c=i.n(s),d=i("msXN"),u=i("NYxO"),f=(i("ttkU"),i("gyMJ")),m={mixins:[d.a],data:function(){return{singerId:"",singerName:"",centerDialogVisible:!1,editVisible:!1,delVisible:!1,registerForm:{name:"",singerName:"",introduction:"",lyric:""},form:{id:"",name:"",introduction:""},tableData:[],tempData:[],select_word:"",pageSize:5,currentPage:1,idx:-1,multipleSelection:[],toggle:!1}},computed:c()({},Object(u.b)(["isPlay"]),{data:function(){return this.tableData.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize)}}),watch:{select_word:function(){if(""==this.select_word)this.tableData=this.tempData;else{this.tableData=[];var t=!0,e=!1,i=void 0;try{for(var n,a=l()(this.tempData);!(t=(n=a.next()).done);t=!0){var o=n.value;o.name.includes(this.select_word)&&this.tableData.push(o)}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}}}},created:function(){this.singerId=this.$route.query.id,this.singerName=this.$route.query.name,this.getData()},destroyed:function(){this.$store.commit("setIsPlay",!1)},methods:(n={handleCurrentChange:function(t){this.currentPage=t},getData:function(){var t=this;this.tempData=[],this.tableData=[],Object(f.p)(this.singerId).then(function(e){t.tempData=e,t.tableData=e,t.currentPage=1})},addSong:function(){var t=this,e=new FormData(document.getElementById("tf"));e.append("singerId",this.singerId),e.set("name",this.singerName+"-"+e.get("name")),e.get("lyric")||e.set("lyric","[00:00:00]暂无歌词");var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var e=JSON.parse(i.response);1==e.code?(t.getData(),t.registerForm={},t.notify(e.msg,"success")):(console.log(e),console.log(i),t.notify("保存失败","error"))}},i.open("post",t.$store.state.HOST+"/song/add",!1),i.send(e),t.centerDialogVisible=!1},handleEdit:function(t){this.editVisible=!0,this.form={id:t.id,name:t.name,introduction:t.introduction,lyric:t.lyric}},editSave:function(){var t=this,e=new URLSearchParams(e);e.append("id",this.form.id),e.append("name",this.form.name),e.append("introduction",this.form.introduction),e.append("lyric",this.form.lyric),Object(f.u)(e).then(function(e){1==e.code?(t.getData(),t.notify("修改成功","success")):t.notify("修改失败","error")}).catch(function(t){console.log(t)}),this.editVisible=!1},uploadUrl:function(t){},deleteRow:function(){var t=this;Object(f.e)(this.idx).then(function(e){e?(t.getData(),t.notify("删除成功","success")):t.notify("删除失败","error")}).catch(function(t){console.log(t)}),this.delVisible=!1},parseLyric:function(t){var e=t.split("\n"),i=/\[\d{2}:\d{2}.(\d{2}|\d{3})\]/g,n=[],a=!0,o=!1,r=void 0;try{for(var s,c=l()(e);!(a=(s=c.next()).done);a=!0){var d=s.value.replace(i,"");n.push(d)}}catch(t){o=!0,r=t}finally{try{!a&&c.return&&c.return()}finally{if(o)throw r}}return n}},o()(n,"uploadUrl",function(t){return this.$store.state.HOST+"/song/updateSongPic?id="+t}),o()(n,"beforeSongUpload",function(t){return"mp3"==t.name.substring(t.name.lastIndexOf(".")+1)||(this.$message({message:"上传文件只能是mp3格式",type:"error"}),!1)}),o()(n,"handleSongSuccess",function(t){1===t.code?(this.getData(),this.$notify({title:"上传成功",type:"success"})):this.$notify({title:"上传失败",type:"error"})}),o()(n,"uploadSongUrl",function(t){return this.$store.state.HOST+"/song/updateSongUrl?id="+t}),o()(n,"setSongUrl",function(t,e){this.toggle=e,this.$store.commit("setUrl",this.$store.state.HOST+t),this.isPlay?this.$store.commit("setIsPlay",!1):this.$store.commit("setIsPlay",!0)}),n)},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table"},[t._m(0),t._v(" "),i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.delAll}},[t._v("\n        批量删除\n      ")]),t._v(" "),i("el-input",{staticClass:"handle-input",attrs:{size:"mini",placeholder:"请输入歌曲名"},model:{value:t.select_word,callback:function(e){t.select_word=e},expression:"select_word"}}),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.centerDialogVisible=!0}}},[t._v("\n        添加歌曲\n      ")])],1)]),t._v(" "),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",height:"680px",data:t.data},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),i("el-table-column",{attrs:{label:"歌曲图片",width:"100%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"song-img"},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.getUrl(e.row.pic)}})]),t._v(" "),i("div",{staticClass:"play",on:{click:function(i){return t.setSongUrl(e.row.url,e.row.name)}}},[t.toggle==e.row.name?i("div",[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":"#icon-zanting"}})])]):t._e(),t._v(" "),t.toggle!=e.row.name?i("div",[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":"#icon-bofanganniu"}})])]):t._e()]),t._v(" "),i("el-upload",{attrs:{action:t.uploadUrl(e.row.id),"before-upload":t.beforeAvatorUpload,"on-success":t.handleAvatorSuccess}},[i("el-button",{attrs:{size:"mini"}},[t._v("更新图片")])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"歌手-歌名",width:"120",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"introduction",label:"专辑",width:"150",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"歌词",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("ul",{staticStyle:{height:"200px",overflow:"scroll","font-size":"large"}},t._l(t.parseLyric(e.row.lyric),function(e,n){return i("li",{key:n},[t._v("\n            "+t._s(e)+"\n          ")])}),0)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"资源更新",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-upload",{attrs:{action:t.uploadUrl(e.row.id),"before-upload":t.beforeAvatorUpload,"on-success":t.handleAvatorSuccess}},[i("el-button",{attrs:{size:"mini"}},[t._v("更新图片")])],1),t._v(" "),i("br"),t._v(" "),i("el-upload",{attrs:{action:t.uploadSongUrl(e.row.id),"before-upload":t.beforeSongUpload,"on-success":t.handleSongSuccess}},[i("el-button",{attrs:{size:"mini"}},[t._v("更新歌曲")])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.handleDelete(e.row.id)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{total:t.tableData.length,"current-page":t.currentPage,"page-size":t.pageSize,layout:"total,prev,pager,next"},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:"添加歌曲",visible:t.centerDialogVisible,width:"400px",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[i("el-form",{ref:"registerForm",attrs:{model:t.registerForm,"label-width":"80px",action:"",id:"tf"}},[i("div",[i("label",[t._v("歌名")]),t._v(" "),i("el-input",{attrs:{type:"text",name:"name"}})],1),t._v(" "),i("div",[i("label",[t._v("专辑")]),t._v(" "),i("el-input",{attrs:{type:"text",name:"introduction"}})],1),t._v(" "),i("div",[i("label",[t._v("歌词")]),t._v(" "),i("el-input",{attrs:{type:"text",name:"lyric"}})],1),t._v(" "),i("div",[i("label",[t._v("歌曲上传")]),t._v(" "),i("input",{attrs:{type:"file",name:"file"}})])]),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("\n        取消\n      ")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.addSong}},[t._v("确定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"修改歌曲",visible:t.editVisible,width:"400px",center:""},on:{"update:visible":function(e){t.editVisible=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[i("el-form-item",{attrs:{prop:"name",label:"歌手-歌名",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌手-歌名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"introduction",label:"专辑",size:"mini"}},[i("el-input",{attrs:{placeholder:"专辑"},model:{value:t.form.introduction,callback:function(e){t.$set(t.form,"introduction",e)},expression:"form.introduction"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"lyric",label:"歌词",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌词",type:"textarea"},model:{value:t.form.lyric,callback:function(e){t.$set(t.form,"lyric",e)},expression:"form.lyric"}})],1)],1),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.editVisible=!1}}},[t._v("\n        取消\n      ")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.editSave}},[t._v("确定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"删除歌曲",visible:t.delVisible,width:"300px",center:""},on:{"update:visible":function(e){t.delVisible=e}}},[i("div",{attrs:{align:"center"}},[t._v("删除不可恢复，是否确定删除？")]),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.delVisible=!1}}},[t._v("\n        取消\n      ")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.deleteRow}},[t._v("确定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"crumbs"},[e("i",{staticClass:"el-icon-tickets"}),this._v("\n    歌曲信息\n  ")])}]};var v=i("VU/8")(m,p,!1,function(t){i("f69m")},"data-v-7258ff00",null);e.default=v.exports},bOdI:function(t,e,i){"use strict";e.__esModule=!0;var n,a=i("C4MV"),o=(n=a)&&n.__esModule?n:{default:n};e.default=function(t,e,i){return e in t?(0,o.default)(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},f69m:function(t,e){},mClu:function(t,e,i){var n=i("kM2E");n(n.S+n.F*!i("+E39"),"Object",{defineProperty:i("evD5").f})},ttkU:function(t,e){!function(t){var e,i='<svg><symbol id="icon-bofanganniu" viewBox="0 0 1024 1024"><path d="M927.870095 571.688039 167.320423 1014.160886C121.562471 1041.981153 61.44 1007.279555 61.44 954.218179L61.44 68.595037C63.693916 16.802233 124.631347-17.041827 171.276012 8.961322L928.382003 451.43039C974.037627 479.202079 974.037627 543.611136 927.870095 571.688039Z"  ></path></symbol><symbol id="icon-zanting" viewBox="0 0 1024 1024"><path d="M268.97201558 114.31784297c73.21218086 0 132.56071902 59.34853814 132.56071901 132.560719v530.24287606c0 73.21218086-59.34853814 132.56071902-132.56071901 132.560719s-132.56071902-59.34853814-132.56071901-132.560719V246.87856197c0-73.21218086 59.34853814-132.56071902 132.56071901-132.560719z m486.05596884 0c73.21218086 0 132.56071902 59.34853814 132.56071901 132.560719v530.24287606c0 73.21218086-59.34853814 132.56071902-132.56071901 132.560719s-132.56071902-59.34853814-132.56071901-132.560719V246.87856197c0-73.21218086 59.34853814-132.56071902 132.56071901-132.560719z"  ></path></symbol></svg>';if((e=document.getElementsByTagName("script"))[e.length-1].getAttribute("data-injectcss")&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}!function(e){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(e,0);else{document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t,!1),e()},!1)}else document.attachEvent&&(n=e,a=t.document,o=!1,(r=function(){try{a.documentElement.doScroll("left")}catch(t){return void setTimeout(r,50)}i()})(),a.onreadystatechange=function(){"complete"==a.readyState&&(a.onreadystatechange=null,i())});function i(){o||(o=!0,n())}var n,a,o,r}(function(){var t,e;(t=document.createElement("div")).innerHTML=i,i=null,(e=t.getElementsByTagName("svg")[0])&&(e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.width=0,e.style.height=0,e.style.overflow="hidden",function(t,e){e.firstChild?function(t,e){e.parentNode.insertBefore(t,e)}(t,e.firstChild):e.appendChild(t)}(e,document.body))})}(window)}});
//# sourceMappingURL=1.c9823bc19f667c2032e2.js.map